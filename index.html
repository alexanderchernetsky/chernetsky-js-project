<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="style.css">
    <title>racing game project</title>
  </head>
  <body>
    <div class="canvas-wrapper"></div>
    <div class="game-end-wrapper">
      <p class="info">
        <span>game over!</span><br>
        <span id="score"></span>
      </p>
      <input id="player-name" type="text" placeholder="enter your name"><br>
      <input type="button" value="save result"><br>
      <input type="button" value="high scores"><br>
      <input type="button" value="new game"><br>
      <input type="button" value="main menu"><br>
    </div>
    <div class="game-end-background"></div>
    
    <div class="wallpaper"></div>
    <div class="buttons-container">
      <input id='game' type="button" value="new game">
      <input id='controls' type="button" value="rules and controls">
      <input id='leaderboard' type="button" value="high scores">
      <input id='about' type="button" value="about">
    </div>

    <script src="jquery-3.3.1.min.js"></script>
    <script>
      function switchToState(state) {
        return location.hash = encodeURIComponent(JSON.stringify(state));
      }
      
      function switchToMainPage() {
        switchToState({page: 'main'});
      }

      function switchToGamePage() {
        switchToState({page: 'game'});
      }
      
      function switchToControlsPage() {
        switchToState({page: 'controls'})
      }
      
      function switchToLeaderboardPage() {
        switchToState({page: 'leaderboard'})
      }

      function switchToAboutPage() {
        switchToState({page: 'about'})
      }

      window.addEventListener('hashchange', renderNewState, false);

      document.getElementById('game').addEventListener('click', switchToGamePage, false);
      document.getElementById('controls').addEventListener('click', switchToControlsPage, false);
      document.getElementById('leaderboard').addEventListener('click', switchToLeaderboardPage, false);
      document.getElementById('about').addEventListener('click', switchToAboutPage, false);

      function renderNewState() {
        let hash = window.location.hash;
        let state = decodeURIComponent(hash.substr(1));
        (state === '') ? (state = {page: 'main'}) : (state = JSON.parse(state));
        switch (state.page) {
          case 'main':
            createMainPage();
            break;
          case 'game':
            createGamePage();
            break;
          case 'controls':
            createControlsPage();
            break;
          case 'leaderboard':
            createLeaderboardPage();
            break;
          case 'about':
            createAboutPage();
            break;
        }
      }

      renderNewState();

      function createMainPage() {
        console.log('main page render');


      }

      function createGamePage() {
        console.log('game page render');
        document.querySelector('.canvas-wrapper').style.display = 'block';


        $.ajax(
            {
              url: 'game.js',
              type: 'GET',
              dataType: 'script',
              success: function (EO) {
                console.log('success!!!')
              },
              error: function (EO) {
                console.log('fail!!!')
              }
            })
      }

      function createControlsPage() {
        console.log('controls page render');
      }

      function createLeaderboardPage() {
        console.log('high scores page render');
      }

      function createAboutPage() {
        console.log('about page render');
      }

    </script>
    <!--<script src="game.js"></script>-->
  </body>
</html>